var Draw=function(){var e,t,n="",c=null,o=null,i=!1,s=!1,r="#FF0000",l=5,d=null,a=0;let u=()=>{let e=document.getElementById("cc-pen-editor");e&&(e.style.display="none")},v=()=>{let e=document.querySelector("#vcc-cursor-focus");u(),_(),document.querySelectorAll(".drawingToolHideShow").forEach((function(e){e.classList.remove("active")})),e&&e.classList.add("active"),document.body.classList.add("vcc-cursor-focus"),n="cursor_focus",y(),Helper.getAdvanceSetting("advanceSettingStatus").then(e=>{(d=e.advanceSettingStatus).canvasTool="focusMouse",Helper.setAdvanceSetting(d)})},m=()=>{let e=document.querySelector("#vcc-draw-pen");document.querySelectorAll(".drawingToolHideShow").forEach((function(e){e.classList.remove("active")})),e&&e.classList.add("active"),n="pen",H(),_(),document.body.classList.add("fde-pen-ico"),y()},g=()=>{let e=document.querySelector("#vcc-draw-eraser");u(),document.querySelectorAll(".drawingToolHideShow").forEach((function(e){e.classList.remove("active")})),e&&e.classList.add("active"),n="eraser",H(),_(),document.body.classList.add("fde-eraser-ico"),y(),Helper.getAdvanceSetting("advanceSettingStatus").then(e=>{(d=e.advanceSettingStatus).canvasTool="eraser",Helper.setAdvanceSetting(d)})},p=()=>{let e=document.querySelector("#vcc-draw-highlight");u(),E(),b(),document.querySelectorAll(".drawingToolHideShow").forEach((function(e){e.classList.remove("active")})),e&&e.classList.add("active"),n="cursor_highlight",y(),Helper.getAdvanceSetting("advanceSettingStatus").then(e=>{(d=e.advanceSettingStatus).canvasTool="highlighter",Helper.setAdvanceSetting(d)})},h=()=>{let e=document.querySelector("#vcc-draw-pen"),t=document.querySelector("#cc-editor-close"),c=document.querySelector(".pen-color"),o=document.querySelector("#vcc-draw-eraser"),i=document.getElementById("pen-size"),s=document.querySelector("#vcc-draw-highlight"),h=document.querySelector("#vcc-cursor-focus"),y=document.querySelector("#vcc-clear-draw");e&&e.addEventListener("click",(function(e){if(0==a)if(a++,"pen"==n)S();else{let e=document.getElementById("cc-pen-editor");e&&(e.style.display="flex"),Helper.getAdvanceSetting("advanceSettingStatus").then(e=>{(d=e.advanceSettingStatus).penMenuOption="open",d.canvasTool="pen",Helper.setAdvanceSetting(d),m()})}setTimeout(()=>{a=0},500),Helper.sendMsgToBgScript("vcc_click_pen_main",null,()=>{})})),t&&t.addEventListener("click",()=>{u(),Helper.sendMsgToBgScript("vcc_click_pen_edit",null,()=>{}),Helper.getAdvanceSetting("advanceSettingStatus").then(e=>{(d=e.advanceSettingStatus).penMenuOption="close",Helper.setAdvanceSetting(d)})}),i&&i.addEventListener("change",e=>{l=i.value;let t=document.getElementById("pen-size-text");t&&(t.innerText=l+"px"),Helper.getAdvanceSetting("advanceSettingStatus").then(e=>{(d=e.advanceSettingStatus).pen_thikness=l,Helper.setAdvanceSetting(d)}).catch(e=>{console.log(e,"<===Get Error into catch")}),Helper.sendMsgToBgScript("vcc_click_pen_thikness",null,()=>{})}),c&&c.addEventListener("click",e=>{r=e.target.getAttribute("data-color");let t=document.getElementById("pen-size");t&&(t.style.color=r),Helper.getAdvanceSetting("advanceSettingStatus").then(e=>{(d=e.advanceSettingStatus).pen_color=r,Helper.setAdvanceSetting(d)}),Helper.sendMsgToBgScript("vcc_click_pen_color",null,()=>{})}),o&&o.addEventListener("click",(function(e){0==a&&(a++,"eraser"==n?S():g()),setTimeout(()=>{a=0},500),Helper.sendMsgToBgScript("vcc_click_eraser",null,()=>{})})),s&&s.addEventListener("click",(function(e){0==a&&(a++,"cursor_highlight"===n?S():p()),setTimeout(()=>{a=0},500),Helper.sendMsgToBgScript("vcc_click_highlighter",null,()=>{})})),h&&h.addEventListener("click",(function(e){0==a&&(a++,"cursor_focus"==n?S():(S(),v())),setTimeout(()=>{a=0},500),Helper.sendMsgToBgScript("vcc_click_focus",null,()=>{})})),y&&y.addEventListener("click",(function(e){u(),document.querySelectorAll(".drawingToolHideShow").forEach((function(e){e.classList.remove("active")})),n="clear_canvas",E(),_(),L(),Helper.sendMsgToBgScript("vcc_click_paint_clean",null,()=>{})}))},S=()=>{u(),document.querySelectorAll(".drawingToolHideShow").forEach((function(e){e.classList.remove("active")})),n="enableClick",E(),_(),y(),Helper.getAdvanceSetting("advanceSettingStatus").then(e=>{(d=e.advanceSettingStatus).canvasTool="enableClick",d.penMenuOption="close",Helper.setAdvanceSetting(d)})},y=()=>{if(s)if("pen"===n){e=o.getContext("2d");var t={x:0,y:0},c={x:0,y:0};e.globalCompositeOperation="source-over",e.lineWidth=l,e.strokeStyle=r,o.addEventListener("mousemove",(function(e){c.x=t.x,c.y=t.y,t.x=e.pageX-this.offsetLeft,t.y=e.pageY-this.offsetTop}),!1),o.addEventListener("mousedown",(function(){o.addEventListener("mousemove",i,!1)}),!1),o.addEventListener("mouseup",(function(){o.removeEventListener("mousemove",i,!1)}),!1);var i=function(){e.lineWidth=l,e.lineJoin="round",e.lineCap="round",e.fillStyle=r,e.strokeStyle=r,e.beginPath(),e.moveTo(c.x,c.y),e.lineTo(t.x,t.y),e.closePath(),e.stroke(),document.querySelector(".fde-pen-ico")||document.body.classList.add("fde-pen-ico")}}else if("eraser"===n){e=o.getContext("2d"),old=null,e.globalCompositeOperation="destination-out",o.addEventListener("mousedown",(function(e){old={x:e.offsetX,y:e.offsetY},o.addEventListener("mousemove",t,!1)}),!1),o.addEventListener("mouseup",(function(e){o.removeEventListener("mousemove",t,!1)}),!1);let t=t=>{var c=t.offsetX,o=t.offsetY;e.beginPath(),e.arc(c,o,40,0,2*Math.PI),e.lineWidth="eraser"===n?30:l,e.beginPath(),e.moveTo(old.x,old.y),e.lineTo(c,o),e.stroke(),old={x:c,y:o}}}else if("cursor_highlight"===n)f();else if("cursor_focus"==n){function d(e){if(e){var t=e.clientX||e.touches[0].clientX,n=e.clientY||e.touches[0].clientY;document.documentElement.style.setProperty("--cursorX",t+"px"),document.documentElement.style.setProperty("--cursorY",n+"px")}}document.addEventListener("mousemove",d),document.addEventListener("touchmove",d)}},f=()=>{b(),document.addEventListener("mousemove",e=>{t.setAttribute("style","top: "+(e.pageY-50)+"px; left: "+(e.pageX-50)+"px;")}),document.addEventListener("click",()=>{t.classList.add("expand"),setTimeout(()=>{t.classList.remove("expand")},500)})},L=()=>{e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height)},E=()=>{o&&(o.style.pointerEvents="none")},H=()=>{o&&(o.style.pointerEvents="auto")},b=()=>{(c=document.createElement("span")).className="vcc-cursor",c.id="vcc-mouse-highlighter",c.style.display="block",c.style.zIndex="9999999999",document.getElementsByTagName("body")[0].appendChild(c),t=document.querySelector(".vcc-cursor"),document.body.classList.remove("fde-pen-ico"),document.body.classList.remove("fde-eraser-ico"),document.body.classList.remove("vcc-cursor-focus")},_=()=>{document.querySelector("#vcc-mouse-highlighter")&&document.querySelector("#vcc-mouse-highlighter").remove(),document.body.classList.remove("fde-pen-ico"),document.body.classList.remove("fde-eraser-ico"),document.body.classList.remove("vcc-cursor-focus"),document.body.style.cursor="auto"};return window.onscroll=()=>{if(o){document.body.scrollHeight>32767&&(alert("Unfortunately, Fluvid does not support pages with this height. Please try again on a different website."),exit());var t=document.body,n=document.documentElement,c=Math.max(t.scrollHeight,t.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight);if(c!=o.height){var i=e.getImageData(0,0,document.body.clientWidth,c);o.width=document.body.clientWidth,o.height=c,e.putImageData(i,0,0)}}},{init:t=>{i||(i=!0,s=t,(o=document.createElement("canvas")).id="cc-fluvid-draw",o.width=document.body.clientWidth,o.height=document.body.clientHeight||screen.height,o.style.background="transparent",o.style.zIndex="1000000000",e=o.getContext("2d"),document.body.appendChild(o),E(),setTimeout((function(){h()}),1e3),Helper.getAdvanceSetting("advanceSettingStatus").then(e=>{if((d=e.advanceSettingStatus).pen_thikness||d.pen_color){l=d.pen_thikness?d.pen_thikness:5;let e=document.getElementById("pen-size"),t=document.getElementById("pen-size-text");t&&(t.innerText=l+"px"),e&&(e.value=l),r=d.pen_color?d.pen_color:"#000",e&&(e.style.color=r)}}))},cleanupCanvas:()=>{n="",document.querySelector("#vcc-mouse-highlighter")&&document.querySelector("#vcc-mouse-highlighter").remove(),document.querySelector("#cc-fluvid-draw")&&document.querySelector("#cc-fluvid-draw").remove(),document.body.classList.remove("fde-pen-ico"),document.body.classList.remove("fde-eraser-ico"),document.body.classList.remove("vcc-cursor-focus"),document.body.style.cursor="auto",c=null,o=null,i=!1,s=!1,u()},focusActionFun:v,penActionFun:m,eraserActionFun:g,highlighterActionFun:p,enableClickElem:S}}();
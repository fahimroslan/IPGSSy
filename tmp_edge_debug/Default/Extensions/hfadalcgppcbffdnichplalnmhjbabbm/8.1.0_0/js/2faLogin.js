!function(){let e=document.getElementById("2faAuthVerifyId"),t=document.getElementById("2faCodeId"),n=document.getElementById("errorMessageDisplay"),o=location.search.split("=")[1],i=document.getElementById("gaAuthModalPopup"),l=document.getElementById("autheticationCodeBoxId"),d=document.getElementById("open2StepRecBoxId"),s=document.getElementById("recoveryModalPopup"),a=document.getElementById("recoveryCodeInput");n&&(n.innerText=""),t.focus(),e&&(e.disabled=!0,e.addEventListener("click",n=>{u("https://api.fluvid.com/api/v1/auth/validate2fa","POST",JSON.stringify({token_2fa:o,code_2fa:t.value})),setTimeout(()=>{t.value="",e.disabled=!0},0)})),t&&(t.addEventListener("input",()=>{let o=t.value;o&&6===o.length?e.disabled=!1:e.disabled=!0,n.innerText=""}),t.addEventListener("keypress",e=>{var t=e.which?e.which:e.keyCode;t>31&&(t<48||t>57)&&e.preventDefault()}));let p=document.getElementById("closeGaPopup");p&&p.addEventListener("click",()=>{Helper.sendMsgToContentScript("fde-finish-googleAuth-popup",null,()=>{}),Helper.sendMsgToMain("fde-finish-googleAuth-popup",null,()=>{})}),l&&l.addEventListener("click",()=>{i.style.display="block",t.focus(),s.style.display="none",n.innerText=""}),t.onkeypress=function(t){13==t.keyCode&&e.click()};let r=document.getElementById("recoveryCodeBtn");async function u(e,t,o){(async function(){let n=await fetch(e,{method:t,headers:{Accept:"application/json","Content-Type":"application/json"},body:o});return await n.json()})().then(e=>{if(200==e.statusCode){let t=e.data.userProfile||null,n=e.data.userToken||null;if(t){Helper.setKeyValue("live_user_profile",JSON.stringify(t));let e=null;t&&t.hasOwnProperty("profile_pic")&&t.profile_pic&&(e=t.profile_pic),Helper.setUserImage(e)}n&&(localStorage.setItem("live_user_token",n),Helper.sendMsgToContentScript("cs_cross_product_login",{token:n,profile:t},()=>{}),Helper.sendMsgToExtensionFile("ext_cross_product_login",{token:n,profile:t},()=>{})),Helper.sendMsgToContentScript("fde-finish-googleAuth-popup",null,()=>{}),Helper.sendMsgToMain("fde-finish-googleAuth-popup",null,()=>{})}else 204==e.statusCode?n.innerText="Your authentication code is incorrect":400==e.statusCode?n.innerText="The google Authenticator code is required.":(n.innerText="Something went wrong please login again",setTimeout(()=>{Helper.sendMsgToContentScript("fde-finish-googleAuth-popup",null,()=>{}),Helper.sendMsgToMain("fde-finish-googleAuth-popup",null,()=>{})},4e3))}).catch(e=>{Helper.log(e,"<==Get from 2f verification"),n.innerText="Something went wrong please login again",setTimeout(()=>{Helper.sendMsgToContentScript("fde-finish-googleAuth-popup",null,()=>{}),Helper.sendMsgToMain("fde-finish-googleAuth-popup",null,()=>{})},4e3)})}d&&d.addEventListener("click",()=>{i.style.display="none",s.style.display="block",a.focus(),n.innerText=""}),r&&(r.disabled=!0,r.addEventListener("click",e=>{u("https://api.fluvid.com/api/v1/auth/validate2faBackup","POST",JSON.stringify({token_2fa:o,code_2fa:a.value})),setTimeout(()=>{a.value="",r.disabled=!0},0)})),a.onkeypress=function(e){13==e.keyCode&&r.click()},a&&a.addEventListener("input",()=>{16===a.value.length?r.disabled=!1:r.disabled=!0,n.innerText=""})}();
let events={CLICK:"click",CHANGE:"change"},bindEventToHandler=(e,n,t)=>{e&&n&&events.hasOwnProperty(n.toUpperCase())?e.addEventListener(events[n.toUpperCase()],t):Helper.error("Error While Binding Event Emitter",n)};const loginBtn=document.getElementById("vcc-login-btn"),fbLoginBtn=document.getElementById("vcc-login-fb-btn"),outlookLoginBtn=document.getElementById("vcc-login-outlook-btn"),appleLoginBtn=document.getElementById("vcc-apple-login-btn"),getPermissionBtn=document.getElementById("vcc-get-permission"),closeModal=document.getElementById("vcc-modal-close"),socialErr=document.getElementById("socialMsgError");bindEventToHandler(loginBtn,"click",(function(){socialErr.innerText="",socialErr.style.display="none",Main.handleLoginEvent("gmail")})),bindEventToHandler(outlookLoginBtn,"click",(function(){socialErr.innerText="",socialErr.style.display="none",Main.handleLoginEvent("outlook")})),bindEventToHandler(fbLoginBtn,"click",(function(){socialErr.innerText="",socialErr.style.display="none",Main.handleLoginEvent("facebook")})),bindEventToHandler(appleLoginBtn,"click",(function(){socialErr.innerText="",socialErr.style.display="none",Main.handleLoginEvent("apple")})),bindEventToHandler(getPermissionBtn,"click",(function(){let e=document.getElementsByName("vcc-cam-access")[0].checked,n=document.getElementsByName("vcc-mic-access")[0].checked;e||n?getCameraMicPermission(e,n):redirectToWelcomePage()})),showLoader=()=>{document.getElementById("vcc-loader").style.display="block",document.getElementById("vcc-step-2").style.display="none",document.getElementById("vcc-step-1").style.display="none"},hideLoader=()=>{document.getElementById("vcc-loader").style.display="none"},openModal=()=>{document.getElementById("vcc-modal-gif").setAttribute("src",""),document.getElementById("vcc-modal-gif").setAttribute("src","./images/Hnet-image.gif"),document.getElementById("exampleModal").style.display="block"},bindEventToHandler(closeModal,"click",(function(){document.getElementById("exampleModal").style.display="none"})),redirectToWelcomePage=()=>{window.open("https://fluvid.com/welcome?utm_source=fluvid&utm_medium=extension&utm_campaign=install","_self")},handleStepper=e=>{switch(e){case 1:document.getElementById("vcc-loader").style.display="none",document.getElementById("vcc-step-2").style.display="none",document.getElementById("vcc-step-1").style.display="block";break;case 2:document.getElementById("vcc-loader").style.display="none",document.getElementById("vcc-step-1").style.display="none",document.getElementById("vcc-step-2").style.display="block"}},getCameraMicPermission=(e,n)=>{let t={video:!1,audio:!1},o={video:!1,audio:!1},i=!0;navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then((function(i){i.forEach((function(e){"audio"!==e.kind&&"audioinput"!==e.kind||(t.audio=!0,e.label&&(o.audio=!0)),"video"!==e.kind&&"videoinput"!==e.kind||(t.video=!0,e.label&&(o.video=!0))}));let a={audio:!0,video:!0};(t.audio&&o.audio||!n)&&(a.audio=!1),(t.video&&o.video||!e)&&(a.video=!1),a.audio||a.video||redirectToWelcomePage(),(a.video||a.audio)&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var n=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return n?new Promise((function(t,o){n.call(navigator,e,t,o)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),navigator.mediaDevices.getUserMedia(a).then((function(e){e.getTracks().forEach((function(e){e.stop()})),redirectToWelcomePage()})).catch(e=>{"NotAllowedError"===e.name&&"Permission denied"===e.message&&openModal()})),t.audio,t.video})).catch((function(e){redirectToWelcomePage()})):i=!1};let apiHost="https://api.fluvid.com/api/v1";verifyUserToken=(e,n=null)=>fetch(apiHost+"/auth/verifyToken",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e}});let userToken=localStorage.getItem("live_user_token");userToken&&""!==userToken.trim()?(showLoader(),verifyUserToken(userToken).then(e=>e.json()).then(e=>{e&&"200"==e.statusCode?handleStepper(2):handleStepper(1)}).catch(e=>{handleStepper(1)}).finally(()=>{})):handleStepper(1);const listners=(e,n,t)=>{"ext_cross_product_login"===e.type?handleStepper(2):"ext_cross_product_logout"===e.type&&handleStepper(1),"fde-finish-googleAuth-popup"===e.type&&Helper.remove2FLoginAuth(),"fde-2f-login-token"===e.type?Helper.append2FLoginAuth(e.data):"ext_cross_login_error"===e.type&&(socialErr.style.display="block",e.message.indexOf("Email id is not linked with the facebook profile.")>-1?socialErr.innerHTML="<b>Oops! Sign up Error</b>\n            <br>\n            Looks like there is no email id associated with this Facebook account.\n            <br>\n            Email is required to complete sign up process. Please try again with a different Facebook or Google account.":socialErr.innerText=e.message,setTimeout(()=>{socialErr.innerText="",socialErr.style.display="none"},1e4),handleStepper(1))};chrome.extension.onMessage.addListener((e,n,t)=>{listners(e)});
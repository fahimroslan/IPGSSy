var mediaRecorderObj=null,Helper=function(){const e={1:"SCREEN_CAM_AUDIO_FULLSCREEN",2:"SCREEN_CAM_AUDIO_TAB",3:"SCREEN_CAM_FULLSCREEN",4:"SCREEN_CAM_TAB",5:"SCREEN_AUDIO_FULLSCREEN",6:"SCREEN_AUDIO_TAB",7:"SCREEN_FULLSCREEN",8:"SCREEN_TAB",9:"CAM_AUDIO_FULLSCREEN",10:"CAM_AUDIO_TAB",11:"CAM_FULLSCREEN",12:"CAM_TAB"},t=["AUDIO_DEVICES","VIDEO_DEVICES","SELECTED_AUDIO_DEVICE","SELECTED_VIDEO_DEVICE","vidcorUserProfile","currentTabRecordingInfo","activeTab","activeWindow"];let o=0,r=e=>{var t=chrome.extension.getURL("").replace(/\/$/,"");return e.replace(new RegExp("{FILE_ROOT}","g"),t)},n=async(e,t)=>{try{let o=chrome.extension.getURL("template/"+e),n=await fetch(o);t(r(await n.text()))}catch(e){throw Helper.error("Loading Html Error",e.error),e}},l=(e,t,o)=>{try{let r={type:e,tabId:Helper.getKeyValue("activeTab"),windowId:Helper.getKeyValue("activeWindow"),...t};Helper.log("Sending Msg to Active Tabs"),chrome.tabs.query({url:["http://*/*","https://*/*"],windowType:"normal",currentWindow:!0},(function(e){e&&e[0]&&e[0].id?(Helper.log("Active tab getting msg",r,e[0].id),chrome.tabs.sendMessage(e[0].id,r,e=>{try{chrome.runtime.lastError||(Helper.log("The Content Script got the following Message: "+JSON.stringify(e)),o(e))}catch(e){}})):Helper.log("No Active Tab Detected")}))}catch(e){Helper.log("Error while sending message to Content Script",e.message)}},a=e=>{chrome.storage.local.set({eventActionObj:e},(function(){Helper.log("Value is set to eventActionObj"+e)}))},i=()=>new Promise((e,t)=>{try{chrome.storage.local.get(["eventActionObj"],(function(t){e(t||null)}))}catch(t){e(null)}}),c=e=>{try{return JSON.parse(e)}catch(e){return Helper.error("Parse JSON Error",e.message),null}};return{log:(...e)=>{JSON.parse("false")&&console.log("Logger : ",...e)},error:(...e)=>{JSON.parse("false")&&console.log("Error : ",...e)},sendMsgToBgScript:(e,t,o)=>{try{let r={type:e,msg:"msg_from_main",...t};chrome.runtime.sendMessage(r,(function(e){try{var t=chrome.runtime.lastError;if(t)return o(null),void Helper.log(t.message);if(!e)return void o(null);o(e)}catch(e){}}))}catch(e){Helper.error("Error in Helper JS",e.message)}},sendMsgToContentScript:(e,t,o)=>{try{let r=Helper.getKeyValue("activeTab"),n=Helper.getKeyValue("activeWindow"),a={type:e,tabId:r,windowId:n,...t};chrome.tabs.query({url:["http://*/*","https://*/*"],active:!0,windowType:"normal",currentWindow:!0},(function(r){Helper.log("Tab info",r),r&&r[0]&&r[0].id?chrome.tabs.sendMessage(r[0].id,a,e=>{try{chrome.runtime.lastError||(Helper.log("The Content Script got the following Message: "+JSON.stringify(e)),o(e))}catch(e){}}):l(e,t,o)}))}catch(e){Helper.log("Error while sending message to Content Script",e.message)}},sendMsgToActiveTab:l,broadcastToAllTabs:(e,t,o)=>{try{let r={_type:"ping",type:e,tabId:Helper.getKeyValue("activeTab"),windowId:Helper.getKeyValue("activeWindow"),...t};Helper.log("request",r);let n={url:["http://*/*","https://*/*","chrome-extension://hfadalcgppcbffdnichplalnmhjbabbm/*/*"]};chrome.tabs.query(n,e=>{Helper.log("Available Tabs",e),e&&e.length>0&&e.map(e=>{Helper.log("Msg broadcasted to url = ",e.url),chrome.tabs.sendMessage(e.id,r,e=>{try{chrome.runtime.lastError||(Helper.log("The Content Script got the following Message: "+JSON.stringify(e)),o(e))}catch(e){}})})})}catch(e){Helper.log("Error while sending message to Content Script",e.message)}},getCurrentTabInfo:()=>new Promise((e,t)=>{try{chrome.tabs.query({active:!0,currentWindow:!0},(function(o){Helper.log("tabInfo===>",o),o&&o[0]?e(o[0]):t(null)}))}catch(e){Helper.log("getCurrentTabInfo error ",e.message),t(null)}}),renderFile:e=>new Promise((t,o)=>{try{n(e,e=>{if(!e)throw Error("html empty while rendering");document.querySelector("#vidcor-body")&&(document.querySelector("#vidcor-body").innerHTML=e),t()})}catch(e){o(e)}}),showLoader:()=>{document.getElementById("vidcor-loader").style.display="block"},hideLoader:()=>{document.getElementById("vidcor-loader")&&(document.getElementById("vidcor-loader").style.display="none")},showExtension:()=>{document.getElementById("extention-Show-id")&&(document.getElementById("extention-Show-id").style.display="block")},hideExtension:()=>{document.getElementById("extention-Show-id")&&(document.getElementById("extention-Show-id").style.display="none")},showExtLoader:()=>{let e=$("#extention-loader");e&&e.animate({opacity:1},0)},hideExtLoader:()=>{let e=$("#extention-loader");e&&(e.animate({opacity:0},700),setTimeout(()=>{e.css({display:"none"})},700))},sendMsgToMain:(e,t,o)=>{let r={type:e,...t};chrome.runtime.sendMessage(r,(function(e){try{chrome.runtime.lastError||Helper.log("The Content Script got the following Message: "+JSON.stringify(e))}catch(e){}}))},loadText:n,loadFile:async(e,t)=>{try{let o=e,n=await fetch(o);t(r(await n.text()))}catch(e){throw Helper.error("Loading Html Error",e.error),e}},getRecordingType:()=>(Helper.log("From Helper Js - Correct option is =",o,e[o]),localStorage.getItem("vcc-vidcor-record-type")),setRecordingType:t=>{t&&e[t]?(o=t,localStorage.setItem("vcc-vidcor-record-type",t)):o=0},parseJSON:c,getUserProfile:()=>{let e=localStorage.getItem("live_user_profile");return c(e)},setRecordingStatus:e=>{chrome.storage.local.set({recordingStatus:e},(function(){Helper.log("Value is set to "+e)}))},getRecordingStatus:()=>new Promise((e,t)=>{try{chrome.storage.local.get(["recordingStatus"],(function(t){e(t||null)}))}catch(t){e(null)}}),setCrossStatus:e=>{chrome.storage.local.set({crossStatus:e},(function(){Helper.log("Value is set to "+e)}))},getCrossStatus:()=>new Promise((e,t)=>{try{chrome.storage.local.get(["crossStatus"],(function(t){e(t||null)}))}catch(t){e(null)}}),setMediaConstraints:e=>{chrome.storage.local.set({mediaConstraints:e},(function(){Helper.log("Value is set to "+e)}))},getMediaConstraints:()=>new Promise((e,t)=>{chrome.storage.local.get(["mediaConstraints"],(function(t){e(t||null)}))}),getKeyValue:e=>localStorage.getItem(e),setKeyValue:(e,o)=>{-1!==t.indexOf(e)?localStorage.setItem(e,o):Helper.error("Key Value Pair is not Registered")},setUserImage:e=>{chrome.storage.local.set({"vcc-userimage":e},(function(){Helper.log("Value is set to "+e)}))},getUserImage:()=>new Promise((e,t)=>{chrome.storage.local.get(["vcc-userimage"],(function(t){e(t||null)}))}),setAdvanceSetting:e=>{chrome.storage.local.set({advanceSettingStatus:e},(function(){Helper.log("Value is set to advance cetting "+e)}))},getAdvanceSetting:()=>new Promise((e,t)=>{try{chrome.storage.local.get(["advanceSettingStatus"],(function(t){e(t||null)}))}catch(t){e(null)}}),sendMsgToExtensionFile:(e,t,o)=>{try{let r={type:e,tabId:Helper.getKeyValue("activeTab"),windowId:Helper.getKeyValue("activeWindow"),...t};Helper.log("Sending Msg to Active Tabs"),chrome.tabs.query({url:["chrome-extension://hfadalcgppcbffdnichplalnmhjbabbm/*"],windowType:"normal",currentWindow:!0},(function(e){e&&e[0]&&e[0].id?(Helper.log("Active tab getting msg",e[0].id),chrome.tabs.sendMessage(e[0].id,r,e=>{try{chrome.runtime.lastError||(Helper.log("The Content Script got the following Message: "+JSON.stringify(e)),o(e))}catch(e){}})):Helper.log("No Active Tab Detected")}))}catch(e){}},setRecordingFlag:e=>{chrome.storage.local.set({recordingFlag:e},(function(){Helper.log("Value is set to "+e)}))},getRecordingFlag:()=>new Promise((e,t)=>{try{chrome.storage.local.get(["recordingFlag"],(function(t){e(!!t&&t.recordingFlag)}))}catch(t){e(!1)}}),setChrUserProfile:e=>{chrome.storage.local.set({vcc_chrome_userprofile:e},(function(){}))},getChrUserProfile:()=>new Promise((e,t)=>{chrome.storage.local.get(["vcc_chrome_userprofile"],(function(t){e(t||null)}))}),append2FLoginAuth:e=>{let t=document.getElementById("fde-2flogin-frame"),o=document.createElement("iframe");o.src="chrome-extension://hfadalcgppcbffdnichplalnmhjbabbm/template/2faLogin.html?token_2fa="+e.token_2fa,o.id="fde-2falogin-id",o.setAttribute("allowfullscreen",!0),o.setAttribute("frameBorder","0"),o.style.height="500px",o.style.width="500px",o.style.visibility="hidden",document.getElementById("fde-2falogin-id")||(t.style.display="block",t.appendChild(o)),o.style.visibility="visible"},remove2FLoginAuth:()=>{let e=document.getElementById("fde-2flogin-frame");document.getElementById("fde-2falogin-id")&&(e.innerHTML="")},setPopupSetting:e=>{chrome.storage.local.set({popupStatus:e},(function(){Helper.log("Value is set to advance "+e)}))},getPopupSetting:()=>new Promise((e,t)=>{try{chrome.storage.local.get(["popupStatus"],(function(t){e(t||null)}))}catch(t){e(null)}}),broadcastMessage:(e,t)=>{let o={msg:e,...t};window.parent.postMessage(JSON.stringify(o),"*")},setAppIntegrations:e=>{chrome.storage.local.set({appIntegrations:e},(function(){Helper.log("Value is set to advance cetting "+e)}))},getAppIntegrations:()=>new Promise((e,t)=>{try{chrome.storage.local.get(["appIntegrations"],(function(t){e(t||null)}))}catch(t){e(null)}}),setEventActionObj:a,getEventActionObj:i,setEventActionFun:(e,t)=>{i().then(o=>{eventActionObjData=o.eventActionObj?o.eventActionObj:{},eventActionObjData[e]=t,a(eventActionObjData)}).catch(e=>{console.log(e,"<===Error from Event Action Obj")})}}}();
if(navigator.cookieEnabled)var Main=function(){let e=()=>{try{return bg.test(),!0}catch(e){return!1}},o=o=>{Helper.log("init recording");let r=null,n=Helper.getRecordingType();switch(Helper.log("recordingType = ",n),n=parseInt(n),n){case 1:r={screen:!0,video:!0,audio:!0,fullDesktop:!0};break;case 2:r={screen:!0,video:!0,audio:!0,fullDesktop:!1};break;case 3:r={screen:!0,video:!0,audio:!1,fullDesktop:!0};break;case 4:r={screen:!0,video:!0,audio:!1,fullDesktop:!1};break;case 5:r={screen:!0,video:!1,audio:!0,fullDesktop:!0};break;case 6:r={screen:!0,video:!1,audio:!0,fullDesktop:!1};break;case 7:r={screen:!0,video:!1,audio:!1,fullDesktop:!0};break;case 8:r={screen:!0,video:!1,audio:!1,fullDesktop:!1};break;case 9:r={screen:!1,video:!0,audio:!0,fullDesktop:!0};break;case 10:r={screen:!1,video:!0,audio:!0,fullDesktop:!1};break;case 11:r={screen:!1,video:!0,audio:!1,fullDesktop:!0};break;case 12:r={screen:!1,video:!0,audio:!1,fullDesktop:!1};break;default:n=0,Helper.log("MAIN RECORD ID = ",n),r=null}r&&e()&&bg.taskManager(r,o,n)},r=()=>{e()?bg.cancelRecordingOnServer():Helper.sendMsgToBgScript("bg_cancel_recording",{},()=>{})},n=o=>{Helper.log("Recording Stop"),e()?bg.stopRecording(o):Helper.sendMsgToBgScript("bg_stop_recording",{timer:o},()=>{})},t=()=>{Helper.log("Recording Pause"),e()?bg.pauseRecording():Helper.sendMsgToBgScript("bg_pause_recording",{},()=>{})},i=()=>{Helper.log("Recording Resume"),e()?bg.resumeRecording():Helper.sendMsgToBgScript("bg_resume_recording",{},()=>{})},l=()=>{Helper.log("Checking Login Status 1"),e()?bg.verifyToken():(Helper.sendMsgToBgScript("is_user_logged_in",{},()=>{}),window.location.href.indexOf("/template/onboard.html")>-1&&window.location.reload()),window.location.href.indexOf("/template/onboard.html")},c=(e,o)=>{Helper.sendMsgToExtensionFile("ext_cross_product_login",{},()=>{}),Helper.log("after login method called",e),Helper.setRecordingType(1),Helper.hideLoader(),Helper.renderFile("extension.html").then(()=>{e&&e.hasOwnProperty("profile_pic")&&e.profile_pic?(Helper.log("profile_pic",e.profile_pic),Event.saveUserProfile(e.profile_pic)):Helper.log("profile_pic not found"),Event.loadExtensionEventListeners(),Event.renderMediaDeviceList(),a()}).catch(e=>{Helper.error("Error while loading extension.html",e.message)}).finally(()=>{Helper.sendMsgToContentScript("cs_user_logged_in",{recordingStatus:o},()=>{});let e=localStorage.getItem("live_user_token"),r=localStorage.getItem("live_user_profile");Helper.log("Usertoken of user",e,r),e&&Helper.sendMsgToContentScript("cs_cross_product_login",{token:e,profile:r},()=>{})})},s=e=>{Helper.hideLoader(),Helper.sendMsgToExtensionFile("ext_cross_product_logout",{},()=>{}),Helper.error("Error while checking for login status",e),Helper.renderFile("login.html").then(Event.loadSignInPageEventListeners),Helper.sendMsgToContentScript("cs_cross_product_logout",{},()=>{})},a=()=>{let e=navigator.connection.downlink,o=navigator.connection.effectiveType;e="slow-2g"==o||"2g"==o||"3g"==o?70*+navigator.connection.downlink/100:navigator.connection.downlink;let r=document.getElementById("setInternetColor"),n=document.getElementById("setInternetText");0==e?(r.style.backgroundColor="red",n.innerText="No internet connection"):e>0&&e<1?(r.style.backgroundColor="#F00A0A",n.innerText="Internet Speed is Poor for recording and cloud syncing"):e>=1&&e<3?(r.style.backgroundColor="#DFE20A",n.innerText="Internet Speed is Average for recording and cloud syncing"):e>=3&&e<10?(r.style.backgroundColor="#7FCE2A",n.innerText="Internet Speed is Good for recording and cloud syncing"):e>=10&&e<25?(r.style.backgroundColor="#0BAD0E",n.innerText="Internet Speed is Very Good for recording and cloud syncing"):(r.style.backgroundColor="#046706",n.innerText="Internet Speed is Excellent for recording and cloud syncing")};return chrome.runtime.onMessage.addListener((e,a,p)=>{Helper.log("Event Recieved By Main",e.type),"main_init_recording"===e.type&&o(e.title),"main_cancel_recording"===e.type&&r(),"main_stop_recording"===e.type&&n(e.stopTime),"main_pause_recording"===e.type&&t(),"main_resume_recording"===e.type&&i(),"check_login_status"===e.type&&l(),"logged_in"===e.type&&c(e.profileData,e.recordingStatus),"logged_out"===e.type&&s(e.error),e.type}),{stopRecording:n,logout:()=>{Helper.sendMsgToBgScript("logout_user",{},()=>{}),Helper.sendMsgToContentScript("cs_user_logout",{},()=>{})},pauseRecording:t,resumeRecording:i,handleLoginEvent:e=>{let o=null;if("gmail"===e)o="https://accounts.google.com/o/oauth2/v2/auth?client_id=961754464771-omq5rklnbht14vg2ojl9iinvv678jm27.apps.googleusercontent.com&response_type=token&scope=email profile&state=yt&redirect_uri=https://fluvid.com/login";else if("facebook"===e)o="https://www.facebook.com/v6.0/dialog/oauth?client_id=471905066815168&response_type=token&redirect_uri=https://fluvid.com&state=fb&scope=email&auth_type=rerequest";else if("outlook"===e)o="https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=3b82bb20-66c6-4b1c-96af-5abd8ba25311&response_type=token&redirect_uri=https://fluvid.com/login&response_mode=fragment&prompt=select_account&scope=user.read,mail.read,openid,profile&state=outlook";else if("apple"===e){o=`https://appleid.apple.com/auth/authorize?response_type=code&redirect_uri=${"https://api.fluvid.com/api/v1/auth/login/apple/callback"}&client_id=${"com.fluvid.apple"}&state=apple&scope=name email&response_mode=form_post`,window.addEventListener("message",e=>{Helper.sendMsgToBgScript("bg_apple_login",{envRsp:e.data})})}Helper.log("Login Url",o),o&&Helper.getCurrentTabInfo().then(e=>{if(e){Helper.log("Login hanler Success Called");let r=e.height/2-300?e.height/2-300:0,n=e.width/2-250?e.width/2-250:0;window.open(o,"VidCor Login",`width=600,height=600,top=${r},left=${n},scrollbars=no,resizable=no`);let t=null,i=setInterval(()=>{t=localStorage.getItem("live_user_token"),null!=t&&""!=t&&(l(),clearInterval(i))},1e3)}}).catch(e=>{Helper.log("Login hanler Error called"),window.open(o,"VidCor Login","width=600,height=600,top=10,left=325,scrollbars=no,resizable=no")})},checkLoginStatus:l,isLoggedIn:c,notLoggedIn:s,initRecording:o,renderCamViewOnScreen:e=>{try{Helper.sendMsgToContentScript("cs_capture_cam_audio",{mediaConstraints:e},()=>{})}catch(e){Helper.error("ERROR WHILE INITING")}},communicateWithContentScript:e=>{let o="";switch(e){case"start":o="popup_init_recording";break;case"stop":o="popup_stop_recording";break;case"cancel":o="popup_cancel_recording";break;case"mediaDevices1":o="get_available_media_devices";break;case"cs_user_logged_in":o="cs_user_logged_in"}o&&Helper.sendMsgToContentScript(o,{},()=>{})},enableCorrectOption:e=>{e.screen&&e.camera&&e.audio&&e.fullDesktop?Helper.setRecordingType(1):e.screen&&e.camera&&e.audio&&!e.fullDesktop?Helper.setRecordingType(2):e.screen&&e.camera&&!e.audio&&e.fullDesktop?Helper.setRecordingType(3):e.screen&&e.camera&&!e.audio&&!e.fullDesktop?Helper.setRecordingType(4):e.screen&&!e.camera&&e.audio&&e.fullDesktop?Helper.setRecordingType(5):e.screen&&!e.camera&&e.audio&&!e.fullDesktop?Helper.setRecordingType(6):e.screen&&!e.camera&&!e.audio&&e.fullDesktop?Helper.setRecordingType(7):!e.screen||e.camera||e.audio||e.fullDesktop?!e.screen&&e.camera&&e.audio&&e.fullDesktop?Helper.setRecordingType(9):!e.screen&&e.camera&&e.audio&&!e.fullDesktop?Helper.setRecordingType(10):!e.screen&&e.camera&&!e.audio&&e.fullDesktop?Helper.setRecordingType(11):e.screen||!e.camera||e.audio||e.fullDesktop||Helper.setRecordingType(12):Helper.setRecordingType(8);let o=Helper.getRecordingType();Helper.log("correctOption = ",o)},cancelRecording:r}}();
var loginIntervel;function gmailJs(){let e="https://api.fluvid.com/api/v1";var t=1,n="";let l=[],i=[];var d=null;const o=document.getElementById("loading-page-id");let a=document.getElementById("noSearchData"),s=document.getElementById("noFirstData");const c=document.getElementById("Video-List-Id"),g=document.getElementById("no-video-id"),m=document.getElementById("internet-connected-id"),y=document.getElementById("select-data-status-id"),r=document.getElementById("insertVideoIntoMail"),u=document.getElementById("Gu-Login-Id"),p=document.getElementById("login-user-data-id"),v=document.getElementById("Load-More-id");if(p&&(p.style.display="none"),o&&(o.style.display="block"),document.getElementById("close-gmail-popup")&&document.getElementById("close-gmail-popup").addEventListener("click",()=>{Helper.sendMsgToContentScript("close_gmail_search",{},()=>{})}),navigator.onLine){m&&(m.style.display="none"),d=localStorage.getItem("live_user_token");var h=JSON.parse(localStorage.getItem("live_user_profile"));let e=document.getElementById("logout-user-id");if(d&&h)u.style.display="none",e&&(e.style.display="block"),p.innerHTML=`${h.first_name} ${h.last_name}<br><small>${h.email}</small>`,p.style.display="block",x(),E(t),setTimeout(()=>{window.localStorage.removeItem("gmail-login")},3e3);else{u&&(u.style.display="block"),o&&(o.style.display="none");let t=document.getElementById("searchVideoGetList");t&&(t.style.display="none"),e&&(e.style.display="none")}let l=document.getElementById("getDataViewId");l&&l.addEventListener("click",()=>{x(),n="",E("1")}),document.getElementById("login-gmail-ext-id")&&document.getElementById("login-gmail-ext-id").addEventListener("click",()=>{Main.handleLoginEvent("gmail"),window.localStorage.setItem("gmail-login","1"),S()}),document.getElementById("login-facebook-ext-id")&&document.getElementById("login-facebook-ext-id").addEventListener("click",()=>{Main.handleLoginEvent("facebook"),window.localStorage.setItem("gmail-login","1"),S()}),document.getElementById("login-outlook-ext-id")&&document.getElementById("login-outlook-ext-id").addEventListener("click",()=>{Main.handleLoginEvent("outlook"),window.localStorage.setItem("gmail-login","1"),S()}),document.getElementById("login-apple-ext-id")&&document.getElementById("login-apple-ext-id").addEventListener("click",()=>{Main.handleLoginEvent("apple"),window.localStorage.setItem("gmail-login","1"),S()}),document.getElementById("open-extenstion-id3")&&document.getElementById("open-extenstion-id3").addEventListener("click",()=>{Helper.sendMsgToContentScript("vcc-open-extension-web",null,()=>{}),Helper.sendMsgToContentScript("close_gmail_search",null,()=>{})}),document.getElementById("open-extenstion-id4")&&document.getElementById("open-extenstion-id4").addEventListener("click",()=>{Helper.sendMsgToContentScript("vcc-open-extension-web",null,()=>{}),Helper.sendMsgToContentScript("close_gmail_search",null,()=>{})}),v&&v.addEventListener("click",()=>{v.innerText="Loading..",v.disabled=!0,t++;let e=document.getElementById("searchVideoGetList").value;e&&e.length>2?b(t,e):E(t)})}else m.style.display="block",o.style.display="none",c.style.display="none",g.style.display="none";async function E(t){l&&0==l.length&&(y.innerHTML="No video selected"),u.style.display="none",o.style.display="block",r.disabled=!0,async function(){let n="/storage/myStorageVideoList?limit=9&page="+t+"&sorting=created_at&order=desc&token="+d+"&fileStatus=1",l=await fetch(e+n);return await l.json()}().then(e=>{let n=e.data.data,l=e.data.last_page;v.style.display=l===t?"none":"inline-block",n&&n.length>0?(document.getElementById("searchVideoGetList").style.display="block",L(n),T(),B(),v.innerText="Load More",v.disabled=!1):_()}).catch(e=>{_(),console.log(e,"<==Get from video list")})}let I=document.getElementById("searchVideoGetList"),k=document.getElementById("clearSearchId");async function b(n,l){t=1,async function(){let t="/search?limit=9&q="+l+"&token="+d+"&page="+n+"&trash=0",i=await fetch(e+t);return await i.json()}().then(e=>{let t=e.data&&e.data.searchResult&&e.data.searchResult.videos?e.data.searchResult.videos:[];t&&t.length<9&&(v.style.display="none"),t&&t.length>0?(L(t),T(),B(),v.innerText="Load More",v.disabled=!1):async function(){o.style.display="none",c.style.display="none",g.style.display="block",s.style.display="block",s.style.display="none"}()}).catch(e=>{_(),console.log(e,"<==Get from video list")})}async function L(t){for(let e=0;e<t.length;e++){const l=t[e];n+=`<li>\n                                <div class="gm-video-block">\n                                    <div class="gm-view gm-view-first">\n                                        <img src="${l.thumbnails.default}">\n                                        <div class="gm-mask">\n                                            <div class="gm-chkdv">\n                                            <input type="checkbox" name="checkbox" data-value="${l.videoid}" id="checkbox_${l.videoid}" data-thaimnail="${l.thumbnails.default}" class="gmchk seletect-checkbox">\n                                            <label>&nbsp;</label>\n                                            </div>\n                                            <a href="https://fluvid.com/videos/detail/${l.videoid}" target="_blank">\n                                                <img src="../template/images/play-ico.png" class="play-icon">\n                                            </a>\n\n                                            <a href="https://fluvid.com/videos/detail/${l.videoid}"  target="_blank">\n                                                <div class="gm-edit tooltip-item">\n                                                    <span class="tooltip-hint">Edit Video</span>\n                                                    &nbsp;\n                                                </div>\n                                            </a>\n                                            <div class="gm-del click-del-btn tooltip-item" data-value="${l.videoid}">\n                                            <span class="tooltip-hint" style="width:66px; right:-2px;">Delete Video</span>\n                                                &nbsp;\n                                            </div>\n                                        </div>\n                                    </div>\n                                    \n                                    <h4 class="gm-h4-titel" data-value="${l.videoid}" data-thaimnail="${l.thumbnails.default}">\n                                        <a href="https://fluvid.com/videos/detail/${l.videoid}" target="_blank">${l.title}</a>\n                                    </h4>\n                                </div>\n                            </li>`}document.getElementById("lsitOf-video-id").innerHTML=n,async function(){let t=document.querySelectorAll(".click-del-btn");for(var n=0;n<t.length;n++)t[n].addEventListener("click",t=>{if(confirm("Are you sure you want to trash the video?")){let n=t.target.getAttribute("data-value"),i=e+"/videos/archive?token="+d;const o={method:"DELETE",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({restore:!1,videoIds:[n]})};fetch(i,o).then(e=>e.json()).then(e=>{if(200===e.statusCode){let n=e.data.videos[0].title.length<60?e.data.videos[0].title:e.data.videos[0].title.substr(0,60)+"..";document.getElementById("message-id").innerText=e.message+" "+n,setTimeout(()=>{document.getElementById("message-id").innerText=""},5e3),t.target.closest("li").style.display="none"}}).catch(e=>{console.log(e,"<===Error into delete video")}),l.indexOf(n)>-1&&document.getElementById("checkbox_"+n).click()}})}(),r.disabled=!(l&&l.length>0),l&&l.length>0&&l.forEach(e=>{document.getElementById("checkbox_"+e).closest(".gm-mask").classList.add("active"),document.getElementById("checkbox_"+e).checked=!0})}async function B(){let e=document.querySelectorAll(".seletect-checkbox");for(var t=0;t<e.length;t++)e[t].addEventListener("click",e=>{if(1==e.target.checked)l.push(event.target.getAttribute("data-value")),i.push(event.target.getAttribute("data-thaimnail")),e.target.closest(".gm-mask").classList.add("active");else{let t=l.indexOf(event.target.getAttribute("data-value"));l.splice(t,1),i.splice(t,1),e.target.closest(".gm-mask").classList.remove("active")}y.innerHTML=l&&l.length>1?"<b>"+l.length+"</b> videos selected":1==l.length?"<b>1</b> video selected":"No video selected",r.disabled=!(l&&l.length>0)},!1)}I&&I.addEventListener("input",e=>{let t=I.value;o.style.display="block",t&&t.length>2&&(x(),n="",b(1,t)),t&&0===t.length&&(x(),n="",E("1")),t&&t.length>0?k.style.display="block":k.style.display="none"}),k&&k.addEventListener("click",()=>{I.value="",k.style.display="none",x(),E("1")}),r&&r.addEventListener("click",()=>{Helper.sendMsgToContentScript("vcc-compose-mail",{videoIds:l,thumbnails:i},()=>{});let e=document.querySelectorAll(".seletect-checkbox");for(var t=0;t<e.length;t++)e[t].checked=!1});let f=document.getElementById("logout-user-id");async function S(){loginIntervel=setInterval(()=>{d=localStorage.getItem("live_user_token");var e=JSON.parse(localStorage.getItem("live_user_profile"));d&&(E(t),p.innerHTML=`${e.first_name} ${e.last_name}<br><small>${e.email}</small>`,p.style.display="block",f.style.display="block",clearInterval(loginIntervel),setTimeout(()=>{window.localStorage.removeItem("gmail-login")},3e3))},1e3)}async function _(){o.style.display="none",c.style.display="none",g.style.display="block",a.style.display="none",s.style.display="block"}async function x(){o.style.display="block",c.style.display="none",g.style.display="none"}async function T(){o.style.display="none",c.style.display="block",g.style.display="none"}f&&f.addEventListener("click",()=>{Main.logout(),f.style.display="none";let e=document.getElementById("searchVideoGetList");e&&(e.style.display="none"),document.getElementById("Gu-Login-Id").style.display="block",document.getElementById("no-video-id").style.display="none",document.getElementById("Video-List-Id").style.display="none",document.getElementById("loading-page-id").style.display="none",document.getElementById("internet-connected-id").style.display="none",p.style.display="none"})}gmailJs();